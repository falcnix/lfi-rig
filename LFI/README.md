# The Mechanics of Laser Fault Injection
LFI leverages the interaction between focused laser light and semiconductor materials to introduce faults in an IC’s operation. By precisely targeting the silicon die, an attacker can induce errors in the chip’s processing, leading to compromised security or system failures. The ability to control the timing and location of these faults is what makes LFI particularly potent.

# Beams and Spots
When a laser beam is focused onto the surface of an IC, its energy distribution follows a Gaussian curve. This characteristic of laser light is advantageous in LFI, as it allows for precise control over the laser’s impact area. The Gaussian profile means that the highest energy is concentrated at the center of the beam, with the intensity gradually decreasing toward the edges. When the laser hits the die surface from the backside, some of that energy is absorbed by the silicon layers.
Gaussian energy distribution of the laser beam spot

![Laser beam spot distribution](/Other/Images/gaussian_distribution.png)

This decay directly impacts the apparent spot size of the laser beam. While the physical spot size is defined by the diameter at which the beam’s intensity falls to a certain fraction of its maximum value (often 1/e² of the maximum intensity), the effective area impacted by the laser is larger due to the gradual falloff of energy. By carefully adjusting the laser’s power or pulse duration, we can reduce the apparent spot size on the other side of the die, effectively controlling the energy absorbed by the silicon.

Let’s consider a practical example. Suppose the minimum amount of energy required to penetrate the entire die through the backside is 0.15 (arbitrary units). This represents the smallest apparent spot size on the die, just enough to excite electrons in the transistor junction. Now, if we increase the pulse length or the power of the laser while maintaining the same spot size, we deliver more energy to the die, saturating a larger area. The dotted lines represent the width of the narrowest pulse we can achieve (red curve). As the pulse length increases or more power is applied, the affected area widens.

![Effect of pulse length or power](/Other/Images/pulse_length_vs_spot_size_intensity_with_guidelines.png)

In practical terms, if you want to flip single bits, you should optimize the power and pulse length to be just enough to penetrate the die. On the other hand, if your goal is to flip bits across a larger area, simply increase the power. Thus, rather than being a limitation, the natural falloff in energy becomes a tool for more precise and controlled fault injection.
How Laser Light Interacts with Semiconductor Materials

The effectiveness of LFI is rooted in the physical interactions between laser light and the semiconductor materials that make up an IC. The laser light can generate electron-hole pairs in the silicon substrate, leading to localized disruptions in the chip’s operation.

# Generation of Electron-Hole Pairs
When the laser beam strikes the silicon, its photons interact with the semiconductor material, generating electron-hole pairs through a process known as photoelectric excitation. The energy of the photons, in our case in the 1064nm infrared (IR) range, is sufficient to excite electrons from the valence band to the conduction band, creating free carriers that can move under the influence of an electric field.

This generation of electron-hole pairs is highly localized to the area where the laser is focused. The density of these pairs is greatest at the center of the laser spot, corresponding to the peak of the Gaussian intensity distribution of the beam. As these carriers are generated, they can cause transient changes in the voltages within the IC, leading to faults, or uncontrolled outputs.

The presence of these free carriers can significantly impact the operation of transistors within the IC. The additional carriers generated by the laser can either inject charge into the gate oxide or modulate the channel conductance, depending on the specific design and biasing of the transistor.

![Laser hitting NMOS](/Other/Images/nmos-laser.png)

For example, if the laser pulse targets the drain of an NMOS transistor in an off-state, the injected carriers can temporarily charge the drain region, effectively turning the transistor on for a brief period. This can cause a logic gate to output an incorrect value, which may propagate through the circuit and result in a fault.
Effect on Sense Amplifiers

Sense amplifiers, particularly those used in memory circuits, are among the most sensitive components to laser-induced faults. These amplifiers are designed to detect very small voltage differences and are, therefore, highly susceptible to the disruptions caused by laser-induced carriers.

When a laser pulse targets a sense amplifier, it can cause a temporary imbalance in the voltages being sensed, leading to incorrect amplification and data readout. For instance, in an SRAM cell, the laser could cause the sense amplifier to incorrectly interpret a stored ‘0’ as a ‘1’, resulting in a bit flip. This type of fault is particularly dangerous in secure systems, where data integrity is paramount.

# The Importance of Wavelength
When performing LFI through the backside of the IC, the wavelength of the laser plays a critical role in determining how effectively it can penetrate the silicon substrate and induce faults. The silicon substrate used in the IC manufacturing is “invisible” to light in the Infrared region. In technical terms, the absorption coefficient of the silicon substrate drastically drops as you approach a 1000nm wavelength. Consequently, wavelengths over 1000nm can penetrate the silicon substrate and reach the deeper layers where active components like transistors and sense amplifiers reside. This makes it possible to induce faults not just on the surface of the chip but deep within its structure, enabling attacks on buried circuitry.


# Expanding Possibilities with Moving Mirrors
One of the most significant advantages of our LFI rig is its use of fast-moving mirrors, which opens up a world of possibilities that were previously out of reach with traditional rigs where the sample itself needed to be physically moved. Our rig’s moving mirrors, allow for rapid and highly precise manipulation of the laser beam across the surface of the chip, enabling a variety of innovative fault injection patterns that can be tailored to specific attack scenarios.

With the flexibility of moving mirrors, we can now easily implement dynamic patterns such as sweeping a laser beam across an entire array of memory cells or flipping bits along a single line in one swift motion. This capability is particularly powerful when attacking large memory blocks or registers where inducing multiple faults in a single operation can lead to more significant disruptions. Moreover, the ability to create any arbitrary patterns over targeted areas allows us to flip bits in sequence or disrupt multiple regions simultaneously, enhancing the potential impact of the attack.

![Beam patterns](/Other/Images/pattern-visualizations.png)

This creative freedom extends far beyond the previous point and shoot to a single spot. For example, by programming the mirrors to follow a spiral pattern, we can gradually increase the area of influence, potentially causing cascading faults as the beam spirals outward from a central point. Alternatively, more intricate patterns could be designed to exploit specific vulnerabilities in an IC’s architecture, such as targeting the intersections of data buses or clock lines where faults could propagate and cause widespread system errors.

The possibilities are virtually limitless, and this is where the community’s involvement becomes crucial. While we’ve laid the groundwork with our rig, the true potential of these advanced patterns can only be fully realized through collective experimentation and shared insights. We encourage researchers and hobbyists alike to explore different patterns, directions and speeds, document their effects, and contribute to a growing body of knowledge on which patterns work best in various settings and with different types of ICs. Our GitHub repository also has a tool to visualize these patterns.

# Conclusion
In this post, we’ve explored the detailed mechanics of Laser Fault Injection, from the Gaussian beam of the laser spot to the complex interactions between laser light and semiconductor materials. We also discussed the entirely new ideas in executing LFI attacks using arbitrary targeting pattern.

As we continue to refine and explore the capabilities of our low-cost LFI rig, we’re eager to collaborate with the community. Whether you’re a researcher looking to expand on this work or someone new to the field, we invite you to join us in pushing the boundaries of what’s possible.
